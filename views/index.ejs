<!-- ÌïÑÌÑ∞/Ï†ïÎ†¨ ÏÇ¨Ïù¥ÎìúÎ∞î -->
<div id="filter-sidebar" class="filter-sidebar">
    <div class="filter-header">
        <h2><i class="fas fa-filter"></i> ÌïÑÌÑ∞ Î∞è Ï†ïÎ†¨</h2>
        <button id="close-filter-btn" class="close-btn">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <div class="filter-section">
        <h3><i class="fas fa-funnel-dollar"></i> ÌïÑÌÑ∞ÎßÅ</h3>
        <div class="filter-grid">
            <div class="filter-item">
                <label><i class="fas fa-glass-whiskey"></i> ÏúÑÏä§ÌÇ§ ÌÉÄÏûÖ</label>
                <select id="filter-type" class="modern-select">
                    <option value="">Ï†ÑÏ≤¥</option>
                    <option value="Ïã±Í∏Ä Î™∞Ìä∏" <%= filters && filters.type === 'Ïã±Í∏Ä Î™∞Ìä∏' ? 'selected' : '' %>>Ïã±Í∏Ä Î™∞Ìä∏</option>
                    <option value="Î∏îÎ†åÎîîÎìú" <%= filters && filters.type === 'Î∏îÎ†åÎîîÎìú' ? 'selected' : '' %>>Î∏îÎ†åÎîîÎìú</option>
                    <option value="Î≤ÑÎ≤à" <%= filters && filters.type === 'Î≤ÑÎ≤à' ? 'selected' : '' %>>Î≤ÑÎ≤à</option>
                    <option value="ÎùºÏù¥" <%= filters && filters.type === 'ÎùºÏù¥' ? 'selected' : '' %>>ÎùºÏù¥</option>
                    <option value="Í∏∞ÌÉÄ" <%= filters && filters.type === 'Í∏∞ÌÉÄ' ? 'selected' : '' %>>Í∏∞ÌÉÄ</option>
                </select>
            </div>
            <div class="filter-item">
                <label><i class="fas fa-won-sign"></i> ÏµúÏÜå Í∞ÄÍ≤© (Ïõê)</label>
                <input type="number" id="filter-min-price" class="modern-input" min="0" placeholder="0" value="<%= filters && filters.minPrice || '' %>">
            </div>
            <div class="filter-item">
                <label><i class="fas fa-won-sign"></i> ÏµúÎåÄ Í∞ÄÍ≤© (Ïõê)</label>
                <input type="number" id="filter-max-price" class="modern-input" min="0" placeholder="Î¨¥Ï†úÌïú" value="<%= filters && filters.maxPrice || '' %>">
            </div>
            <div class="filter-item">
                <label><i class="fas fa-globe"></i> Íµ≠Í∞Ä</label>
                <input type="text" id="filter-country" class="modern-input" placeholder="Ïòà: Ïä§ÏΩîÌãÄÎûúÎìú" value="<%= filters && filters.country || '' %>">
            </div>
            <div class="filter-item">
                <label><i class="fas fa-search"></i> ÏúÑÏä§ÌÇ§ Ïù¥Î¶Ñ Í≤ÄÏÉâ</label>
                <input type="text" id="filter-keywords" class="modern-input" placeholder="Ïòà: Îß•Ï∫òÎûÄ, Í∏ÄÎ†åÌîºÎîï" value="<%= filters && filters.keywords || '' %>">
            </div>
        </div>
    </div>

    <div class="filter-section">
        <h3><i class="fas fa-sort"></i> Ï†ïÎ†¨</h3>
        <div class="filter-grid">
            <div class="filter-item">
                <label><i class="fas fa-list"></i> Ï†ïÎ†¨ Í∏∞Ï§Ä</label>
                <select id="sort-by" class="modern-select">
                    <option value="name" <%= filters && filters.sortBy === 'name' ? 'selected' : '' %>>Ïù¥Î¶Ñ</option>
                    <option value="price" <%= filters && filters.sortBy === 'price' ? 'selected' : '' %>>Í∞ÄÍ≤©</option>
                    <option value="age" <%= filters && filters.sortBy === 'age' ? 'selected' : '' %>>ÏàôÏÑ± Ïó∞Ïàò</option>
                </select>
            </div>
            <div class="filter-item">
                <label><i class="fas fa-sort-amount-down"></i> Ï†ïÎ†¨ ÏàúÏÑú</label>
                <select id="sort-order" class="modern-select">
                    <option value="asc" <%= filters && filters.sortOrder === 'asc' ? 'selected' : '' %>>Ïò§Î¶ÑÏ∞®Ïàú</option>
                    <option value="desc" <%= filters && filters.sortOrder === 'desc' ? 'selected' : '' %>>ÎÇ¥Î¶ºÏ∞®Ïàú</option>
                </select>
            </div>
        </div>
    </div>

    <button id="apply-filter-btn" class="apply-filter-btn">
        <i class="fas fa-check"></i> ÌïÑÌÑ∞ Î∞è Ï†ïÎ†¨ Ï†ÅÏö©
    </button>
    
    <button id="reset-filter-btn" class="reset-btn" onclick="resetFilters()">
        <i class="fas fa-undo"></i> ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
    </button>
</div>

<!-- Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
<main class="main-container">
    <div class="content-wrapper">
        <div class="page-header">
            <h2 class="page-title">
                <i class="fas fa-list"></i> Ï†ÑÏ≤¥ ÏúÑÏä§ÌÇ§ Î™©Î°ù
            </h2>
            <div class="page-actions">
                <button id="open-filter-btn" class="filter-btn">
                    <i class="fas fa-filter"></i> ÌïÑÌÑ∞/Ï†ïÎ†¨
                </button>
            </div>
        </div>

        <div class="content-card">
            <div id="all-whiskey-container" class="whiskey-container">
                <% if (whiskeys && whiskeys.length > 0) { %>
                    <div class="whiskey-grid">
                        <% whiskeys.forEach(whiskey => { %>
                            <div class="whiskey-card" data-whiskey-id="<%= whiskey.whiskey_id %>">
                                <div class="whiskey-image">
                                    <% if (whiskey.image_path) { %>
                                        <img src="<%= whiskey.image_path %>" alt="<%= whiskey.name %>" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                        <div class="whiskey-placeholder" style="display:none;">ü•É</div>
                                    <% } else { %>
                                        <div class="whiskey-placeholder">ü•É</div>
                                    <% } %>
                                </div>
                                <h3 class="whiskey-name"><%= whiskey.name %></h3>
                                <div class="whiskey-info">
                                    <div class="whiskey-details">
                                        <span class="whiskey-type">
                                            <i class="fas fa-glass-whiskey"></i>
                                            <%= whiskey.type || '-' %>
                                        </span>
                                        <span class="whiskey-origin">
                                            <i class="fas fa-globe"></i>
                                            <%= whiskey.origin || '-' %>
                                        </span>
                                        <span class="whiskey-age">
                                            <i class="fas fa-hourglass-half"></i>
                                            <%= whiskey.age_years ? whiskey.age_years + 'ÎÖÑ' : '-' %>
                                        </span>
                                        <span class="whiskey-alcohol">
                                            <i class="fas fa-percentage"></i>
                                            <%= whiskey.alcohol ? whiskey.alcohol + '%' : '-' %>
                                        </span>
                                    </div>
                                    <div class="whiskey-price">
                                        <i class="fas fa-won-sign"></i>
                                        <%= whiskey.price.toLocaleString() %>Ïõê
                                    </div>
                                    <button class="view-detail-btn" onclick="openWhiskeyDetail('<%= whiskey.whiskey_id %>')">
                                        <i class="fas fa-info-circle"></i>
                                        ÏÉÅÏÑ∏Î≥¥Í∏∞
                                    </button>
                                </div>
                            </div>
                        <% }) %>
                    </div>
                <% } else { %>
                    <div class="empty-state">
                        <i class="fas fa-glass-whiskey"></i>
                        <p>ÏúÑÏä§ÌÇ§ Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                    </div>
                <% } %>
            </div>
            
            <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
            <% if (pagination && pagination.totalPages > 1) { %>
                <%
                // ÏøºÎ¶¨ ÌååÎùºÎØ∏ÌÑ∞Î•º URLÏóê Ìè¨Ìï®ÌïòÍ∏∞ ÏúÑÌïú Ìó¨Ìçº Ìï®Ïàò
                function buildPaginationUrl(page) {
                    const params = new URLSearchParams();
                    params.set('page', page);
                    
                    if (pagination.queryParams) {
                        Object.keys(pagination.queryParams).forEach(key => {
                            if (pagination.queryParams[key]) {
                                params.set(key, pagination.queryParams[key]);
                            }
                        });
                    }
                    
                    return '?' + params.toString();
                }
                %>
                <div class="pagination-wrapper">
                    <div class="pagination-info">
                        Ï¥ù <%= pagination.totalWhiskeys %>Í∞úÏùò ÏúÑÏä§ÌÇ§ Ï§ë 
                        <%= ((pagination.currentPage - 1) * 24) + 1 %>~<%= Math.min(pagination.currentPage * 24, pagination.totalWhiskeys) %>Í∞ú ÌëúÏãú
                    </div>
                    <div class="pagination">
                        <% if (pagination.hasPrev) { %>
                            <a href="<%= buildPaginationUrl(1) %>" class="pagination-btn first">
                                <i class="fas fa-angle-double-left"></i>
                            </a>
                            <a href="<%= buildPaginationUrl(pagination.prevPage) %>" class="pagination-btn prev">
                                <i class="fas fa-angle-left"></i>
                            </a>
                        <% } %>
                        
                        <% 
                        let startPage = Math.max(1, pagination.currentPage - 2);
                        let endPage = Math.min(pagination.totalPages, pagination.currentPage + 2);
                        %>
                        
                        <% for (let i = startPage; i <= endPage; i++) { %>
                            <% if (i === pagination.currentPage) { %>
                                <span class="pagination-btn current"><%= i %></span>
                            <% } else { %>
                                <a href="<%= buildPaginationUrl(i) %>" class="pagination-btn"><%= i %></a>
                            <% } %>
                        <% } %>
                        
                        <% if (pagination.hasNext) { %>
                            <a href="<%= buildPaginationUrl(pagination.nextPage) %>" class="pagination-btn next">
                                <i class="fas fa-angle-right"></i>
                            </a>
                            <a href="<%= buildPaginationUrl(pagination.totalPages) %>" class="pagination-btn last">
                                <i class="fas fa-angle-double-right"></i>
                            </a>
                        <% } %>
                    </div>
                </div>
            <% } %>
        </div>
    </div>
</main>
